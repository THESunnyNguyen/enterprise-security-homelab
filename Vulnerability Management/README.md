# Vulnerability Management Lab

---

## Overview

Practiced core vulnerability management workflows using industry-standard tools across a virtualized Windows/Linux network. Covered network reconnaissance, 
web application scanning, and SIEM-based endpoint monitoring.

---

## Environment

<img width="664" height="495" alt="image" src="https://github.com/user-attachments/assets/be737271-e471-47fc-8b45-72f53411065e" />

| Device | OS | Role |
|---|---|---|
| ACIDC01 | Windows Server 2022 | Domain Controller |
| ACIDM01 | Windows Server 2022 | Domain Member / Vulnerable Web Server (XAMPP) |
| ACIWIN11 | Windows 11 Pro | Domain Workstation (SIEM Agent target) |
| ACIALMA | Alma Linux 9.1 | SIEM Manager (Wazuh) |
| ACIKALI | Kali Purple 2023.1 | Attack/Scanning Workstation |

Network subnet: `192.168.0.0/24`

---

## Exercise 1 — Detect Web Application Vulnerabilities

### Task 1: Network Reconnaissance with Nmap

From ACIKALI terminal:
```bash
# Identify local IP
ifconfig eth0

# Ping sweep to discover live hosts
sudo nmap -sn 192.168.0.0/24

# Port scan individual hosts
sudo nmap -Pn 192.168.0.1
sudo nmap -Pn 192.168.0.2
sudo nmap -Pn 192.168.0.4
```

Discovered 6 live hosts. Notable findings:
- `192.168.0.2` (ACIDM01): Ports 80, 443, 3306, 3389 open — confirmed web server
- `192.168.0.4` (ACIKALI): Port 9000 open

<img width="718" height="428" alt="image" src="https://github.com/user-attachments/assets/5e589b82-15ea-4bcb-aaaf-d65cf59d3e58" />

---

### Task 2: Web Vulnerability Scanning with Nikto
```bash
sudo apt install nikto -y

# Scan ACIDM01 web server
sudo nikto -h 192.168.0.2

# Scan ACIALMA on port 9000
sudo nikto -h 192.168.0.4:9000
```

Nikto identified Apache version `2.4.53` running on the target. Cross-referenced findings against the Apache security advisory at `httpd.apache.org/security/vulnerabilities_24.html` to identify associated CVEs fixed in `2.4.56`.

<img width="716" height="388" alt="image" src="https://github.com/user-attachments/assets/2dd5bca7-1b64-48ea-ad1b-c30c63cf5937" />

---

### Task 3: Web App Scanning with OWASP ZAP

Launched OWASP ZAP from Kali (`Applications > Web Application Analysis > zap`), then:

1. Selected **Automated Scan**
2. Enabled **Ajax Spider**
3. Target URL: `http://192.168.0.2/bwapp`
4. Clicked **Attack**

Reviewed findings under the **Alerts** tab — identified vulnerabilities including **Absence of Anti-CSRF Tokens** on the bWAPP vulnerable web application hosted on ACIDM01.

<img width="718" height="515" alt="image" src="https://github.com/user-attachments/assets/1f7e1be9-6b25-4b17-8e80-2b9dabfb58ca" />

---

### Task 4: Port & Service Scanning with Metasploit + Nmap
```bash
# Initialize Metasploit DB and launch console
sudo msfdb init && msfconsole

# TCP port scanner module
use auxiliary/scanner/portscan/tcp
show options
set RHOSTS 192.168.0.4
set PORTS 8000:9000
exploit

# Nmap service version detection from within Metasploit
db_nmap -sV -p 9000 192.168.0.4
```

Confirmed port 9000 open on ACIALMA; identified Apache version and OS through service fingerprinting.

<img width="722" height="119" alt="image" src="https://github.com/user-attachments/assets/97d9c770-20ca-476e-b31e-9e7a322ad7b1" />

---

## Exercise 2 — Monitor Devices for Vulnerabilities (Wazuh SIEM)

### Task 1: Start the Wazuh Manager (ACIALMA)
```bash
sudo systemctl status wazuh-manager   # Confirmed inactive/disabled
sudo systemctl start wazuh-manager
sudo systemctl status wazuh-manager   # Confirmed active (running)
```

Accessed the Wazuh web dashboard at `https://192.168.0.4/` via Firefox on ACIALMA.

<img width="631" height="253" alt="image" src="https://github.com/user-attachments/assets/0fc7bee3-dddb-46b8-b42e-9500654a0e19" />

---

### Task 2: Install the Wazuh Agent on ACIWIN11

From the Wazuh dashboard on ACIALMA:
1. Navigated to **Add Agent > Windows**
2. Set Wazuh server address: `192.168.0.4`
3. Set agent name: `ACIWIN11`, group: `default`
4. Copied the generated PowerShell install command

On ACIWIN11, ran in PowerShell (as Administrator):
```powershell
# Install agent
Invoke-WebRequest -Uri https://packages.wazuh.com/4.x/windows/wazuh-agent-4.5.1-1.msi `
  -OutFile ${env:tmp}\wazuh-agent.msi; msiexec.exe /i ${env:tmp}\wazuh-agent.msi /q `
  WAZUH_MANAGER='192.168.0.4' WAZUH_REGISTRATION_SERVER='192.168.0.4' `
  WAZUH_AGENT_GROUP='default' WAZUH_AGENT_NAME='ACIWIN11'

# Start agent service
NET START Wazuh
```

Verified agent status via **Wazuh Agent Manager > Manage > Status** — confirmed running.

<img width="694" height="227" alt="image" src="https://github.com/user-attachments/assets/00b1d382-07a8-4628-a48e-fd70fcea32f7" />

---

### Task 3: Detect Vulnerabilities on ACIWIN11

From the Wazuh dashboard (ACIALMA):
1. Navigated to **Security Configuration Assessment**
2. Selected agent **ACIWIN11**
3. Opened **CIS Microsoft Windows 11 Enterprise Benchmark v1.0.0**
4. Filtered results by **Failed** checks to surface misconfigurations

Reviewed failed CIS benchmark checks representing real security gaps on the Windows 11 workstation.

<img width="714" height="274" alt="image" src="https://github.com/user-attachments/assets/9fc24c23-4bf1-4dea-a2c1-4d4c4b9b9252" />

---

## Key Takeaways

- Used **Nmap** for host discovery and port enumeration across a live subnet
- Used **Nikto** to fingerprint a web server and map its version to known CVEs
- Used **OWASP ZAP** to actively scan a vulnerable web app (bWAPP) and surface OWASP Top 10 issues
- Used **Metasploit + Nmap** together for service-level reconnaissance from within a framework
- Deployed **Wazuh** as a SIEM — configured the manager, enrolled a Windows agent, and reviewed CIS benchmark compliance failures
